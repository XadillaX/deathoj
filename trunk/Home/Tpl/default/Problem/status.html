<php>
function get_result_color($result)
{
    switch($result)
    {
    case "QUEUING": return "#ff7800";
    case "ACCEPTED": return "red";
    default: return "green";
    }
}
</php>
<include file="Public:header" />
<link rel="stylesheet" type="text/css" href="__ROOT__/default/css/problem.css" media="screen" />

<div id="prob-list-wrapper">
    <table>
        <thead>
            <tr>
                <th style="text-align: center;">RUNID</th>
                <th style="text-align: center;">用户</th>
                <th style="text-align: center;">题号</th>
                <th style="text-align: center;">状态</th>
                <th style="text-align: center;">运行时间(MS)</th>
                <th style="text-align: center;">运行内存(K)</th>
                <th style="text-align: center;">代码长度</th>
                <th style="text-align: center;">语言</th>
                <th style="text-align: center;">提交时间</th>
            </tr>
        </thead>

        <tfoot>
            <tr>
                <td colspan="9" id="page_td">
                    {$page_str}
                </td>
            </tr>
        </tfoot>

        <tbody>
        <foreach name="submit_list" item="list">
            <tr>
                <td style="text-align: center;">{$list.submitid}</td>
                <td style="text-align: center;">{$list.username}</td>
                <td style="text-align: center;"><a style="color: #0072ff;" href="{:U('Problem/view')}?id={$list.index}">{$list.index}</a></td>
                <td style="text-align: center;">
                    <php>
                        $result_ad = false;
                        if($list["message"] != "" && $list["result"] == "COMPILATION_ERROR" && $current_user != NULL && $current_user["userid"] == $list["userid"])
                        {
                            $result_ad = true;
                        }
                    </php>

                    <if condition="$result_ad eq true">
                        <a href="{:U('Problem/viewce')}?submitid={$list['submitid']}" target="_blank">
                            <span style="color: {:get_result_color($list["result"])}">{$list.result}</span>
                        </a>
                    <else />
                        <span style="color: {:get_result_color($list["result"])}">{$list.result}</span>
                    </if>

                    <php>
                        if($list["message"] != "" && $list["result"] == "RUNTIME_ERROR")
                            echo "<br />[" . $list["message"] . "]<br />";
                    </php>
                </td>
                <td style="text-align: center;">{$list.time}</td>
                <td style="text-align: center;">{$list.memory}</td>
                <td style="text-align: center;">{$list.length}</td>
                <td style="text-align: center;">
                    <if condition="($current_user neq null) AND (($current_user['userid'] eq $list['userid']) OR ($current_user['roleid'] eq 3))">
                        <a href="{:U('Problem/viewcode')}?submitid={$list['submitid']}" target="_blank">
                            {$list.language}
                        </a>
                    <else />
                        {$list.language}
                    </if>
                </td>
                <td style="text-align: center;">{:date("Y-m-d H:i:s", $list["submittime"])}</td>
            </tr>
        </foreach>
        </tbody>
    </table>
</div>
<include file="Public:footer" />
